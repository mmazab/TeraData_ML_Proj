<?xml version="1.0" encoding="UTF-8"?>
<QryPlanXML xsi:noNamespaceSchemaLocation="C:\13.1\td_qry_schema_13_1.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<Query QueryID="163833551403145519" CollectTimeStamp="2008-09-25T07:46:05" StartTime ="2008-09-25T10:53:56.03">
<Request QueryText="select employee.name, department.deptname, salary from department, employee where department.deptno = employee.deptno and employee.yrsexp &gt;=5 order by 3 desc;" DefaultDatabaseId="DBpersonnel" NumResultRows="19">
<Statement StatementType="Select" StatementGroup="Select"/>
</Request>
<Plan CacheFlag="false" NumSteps="6" NumStepswPar="0">
<PlanStep StepLev1Num="1" StepName="MLK" StepText=" 1) First, we lock a distinct PERSONNEL.&quot;pseudo table&quot; for read on a RowHash to prevent global deadlock for PERSONNEL.department. ">
<StepDetails>
<MLK>
<LockOperation PseudoTable="true">
<RelationRef Ref="REL1"/>
</LockOperation>
</MLK>
</StepDetails>
</PlanStep>
<PlanStep StepLev1Num="2" StepName="MLK" StepText=" 2) Next, we lock a distinct PERSONNEL.&quot;pseudo table&quot; for read on a RowHash to prevent global deadlock for PERSONNEL.employee.">
<StepDetails>
<MLK>
<LockOperation PseudoTable="true">
<RelationRef Ref="REL2"/>
</LockOperation>
</MLK>
</StepDetails>
</PlanStep>
<PlanStep StepLev1Num="3" StepName="MLK" StepText=" 3) We lock PERSONNEL.department for read, and we lock PERSONNEL.employee for read. ">
<StepDetails>
<MLK>
<LockOperation LockType="R" RowHashFlag="F" LockSeverity="Read" LockLevel="Table" PseudoTable="false">
<RelationRef Ref="REL1"/>
</LockOperation>
<LockOperation LockType="R" RowHashFlag="F" LockSeverity="Read" LockLevel="Table" PseudoTable="false">
<RelationRef Ref="REL2"/>
</LockOperation>
</MLK>
</StepDetails>
</PlanStep>
<PlanStep StepLev1Num="4" StepName="RET" StepText=" 4) We do an all-AMPs RETRIEVE step from PERSONNEL.employee by way of an all-rows scan with a condition of (&quot;(PERSONNEL.employee.YrsExp &gt;= 5&quot;) into Spool 2(all_amps), which is redistributed by the hash code of (PERSONNEL.employee.DeptNo) to all AMPs. Then we do a SORT to order Spool 2 by row hash. The size of Spool 2 is estimated with no confidence to be 6 rows (150 bytes). The estimated time for this step is 0.01 seconds.">
<SourceAccess AccessPosition="1" SyncScanEligible="true">
<RelationRef Ref="REL2"/>
<Predicate PredicateKind="S" PredicateText="(PERSONNEL.employee.YrsExp &gt;= 5)">
<FieldRef Ref="REL2_FLD1030"/>
</Predicate>
</SourceAccess>
<TargetStore GeogInfo="H" Cached="true" EstCardinality="6" Confidence="N">
<SpoolRef Ref="SPOOL2"/>
<SortKey SortKind="RHS"/>
</TargetStore>
<OptStepEst EstCPUCost="0.008" EstIOCost="10.182" EstProcTime=".01" EstRowCount="6"/>
<AmpStepUsage CPUTime="6" IOcount="42" StepRowsReturned="19" />
</PlanStep>
<PlanStep StepLev1Num="5" StepName="JIN" StepText=" 5) We do an all-AMPs JOIN step from Spool 2 (Last Use) by way of a RowHash match scan, which is joined to PERSONNEL.department by way of a RowHash match scan with no residual conditions. Spool 2 and PERSONNEL.department are joined using a merge join, with a join condition of (&quot;PERSONNEL.department.DeptNo = DeptNo&quot;). The result goes into Spool 1 (group_amps), which is built locally on the AMPs. Then we do a SORT to order Spool 1 by the sort key in spool field1(PERSONNEL.employee.Salary). The size of Spool 1 is estimated with no confidence to be 3 rows (171 bytes). The estimated time for this step is 0.05 seconds.">
<SourceAccess AccessPosition="1">
<RelationRef Ref="SPOOL2"/>
</SourceAccess>
<SourceAccess AccessPosition="2">
<RelationRef Ref="REL1"/>
</SourceAccess>
<TargetStore GeogInfo="L" Cached="true" EstCardinality="3" Confidence="N">
<SpoolRef Ref="SPOOL1"/>
<SortKey SortKind="F1S">
<FieldRef Ref="SPOOL2_FLD1029"/>
</SortKey>
</TargetStore>
<Predicate PredicateKind="J" PredicateText=" PERSONNEL.department.DeptNo = DeptNo ">
<FieldRef Ref="REL1_FLD1025"/>
<FieldRef Ref="SPOOL2_FLD1027"/>
</Predicate>
<StepDetails>
<JIN JoinType="I"/>
</StepDetails>
<OptStepEst EstCPUCost="0.012" EstIOCost="60.325" EstProcTime=".06" EstRowCount="3"/>
<AmpStepUsage CPUTime="3" IOcount="69" StepRowsReturned="19" />
</PlanStep>
<PlanStep StepLev1Num="6" StepName="Edt" StepText=" 6) Finally, we send out an END TRANSACTION step to all AMPs involved in processing the request. -&gt; The contents of Spool 1 are sent back to the user as the result of statement 1. The total estimated time is 0.07 seconds.">
</PlanStep>
<OptPlanEst EstResultRows="3" EstProcTime="0.071" />
<AmpPlanUsage TotalIOCount="111" AMPCPUTime="0.0" SpoolUsage="3584" />
</Plan>
<ObjectDefs>
<Database Id="DBpersonnel" DatabaseName="Personnel">
<Relation Id="REL1" DatabaseId="DBpersonnel" TableName="Department" RelationKind="P" Cardinality="4" Confidence="L" Version="1">
<Field Id="REL1_FLD1026" RelationId="REL1" FieldID="1026" FieldName="DeptName" DataLength="14"/>
<Field Id="REL1_FLD1025" RelationId="REL1" FieldID="1025" FieldName="DeptNo" JoinAccessFrequency="1" DataLength="2"/>
<Index Id="REL1_IDX1" RelationId="REL1" IndexNum="1" IndexFlag="false" IndexType="P" UniqueFlag="true">
<FieldRef Ref="REL1_FLD1025"/>
</Index>
</Relation>
<Relation Id="REL2" DatabaseId="DBpersonnel" TableName="Employee" RelationKind="P" Cardinality="18" Confidence="L" Version="1">
<Field Id="REL2_FLD1025" RelationId="REL2" FieldID="1025" FieldName="EmpNo" DataLength="2"/>
<Field Id="REL2_FLD1026" RelationId="REL2" FieldID="1026" FieldName="Name" DataLength="12"/>
<Field Id="REL2_FLD1027" RelationId="REL2" FieldID="1027" FieldName="DeptNo" JoinAccessFrequency="1" RangeAccessFrequency="2" DataLength="2"/>
<Field Id="REL2_FLD1029" RelationId="REL2" FieldID="1029" FieldName="Salary" DataLength="4"/>
<Field Id="REL2_FLD1030" RelationId="REL2" FieldID="1030" FieldName="YrsExp" RangeAccessFrequency="1" DataLength="1"/>
<Index Id="REL2_IDX1" RelationId="REL2" IndexNum="1" IndexFlag="false" IndexType="P" UniqueFlag="true" >
<FieldRef Ref="REL2_FLD1025"/>
</Index>
<Index Id="REL2_IDX4" RelationId="REL2" IndexNum="4" IndexFlag="false" IndexType="S" >
<FieldRef Ref="REL2_FLD1026"/>
</Index>
</Relation>
</Database>
<Database Id="DBdbc" DatabaseName="dbc">
<Spool Id="SPOOL2" SpoolNumber="2" Cardinality="6" SpoolSize="150">
<Field Id="SPOOL2_FLD1026" RelationId="SPOOL2" FieldID="1026" FieldName="Name" DataLength="12"/>
<Field Id="SPOOL2_FLD1027" RelationId="SPOOL2" FieldID="1027" FieldName="DeptNo" DataLength="2"/>
<Field Id="SPOOL2_FLD1029" RelationId="SPOOL2" FieldID="1029" FieldName="Salary" DataLength="4"/>
</Spool>
<Spool Id="SPOOL1" SpoolNumber="1" Cardinality="3" SpoolSize="171"/>
</Database>
</ObjectDefs>
<Configuration MachName="localhost" NumAMPs="2" NumPEs="1" NumNodes="1" ReleaseInfo="13.01.00.00 " VersionInfo=" 13.01.00.00" PENum="16383"/>
<User UserID=" 00000100" UserName="DBC" AcctString="DBC" />
<Session SessionID="1037" LogicalHostID="1"/>
<WLMgmt/>
</Query>
</QryPlanXML>